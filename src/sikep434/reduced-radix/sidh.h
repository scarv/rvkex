#ifndef _SIDH_H
#define _SIDH_H

#include "curve.h"
#include "share.h"
#include "random.h"

static const uint64_t A_gen[6*NLMB56] = {
  0xADF455C5C345BF, 0x5C5CC767AC2B05, 0x79951F02579193, 0x89FA27B1AFE4E8,
  0x48C8CD70E792DC, 0x621FF797F526BB, 0xC42181DB6131AF, 0x00000A1C08B1EC, // XPA0
  0x840EB87CDA7788, 0xAA0ECF9F9D0B74, 0xBDF41715D52971, 0x7AACFFAACB5732,
  0x7E419F8CD8E51F, 0x9E8CA7F424730D, 0x4AD671EB919A17, 0x0000FFA26C5A92, // XPA1
  0xC6E64588B7273B, 0x26D74CBBF1C6FE, 0x07A78098C7D2A6, 0x70841B03F8F58F,
  0x5538DDE23941F4, 0x92151B63EDA204, 0x76735CFEB0FFD4, 0x0001C4CB775428, // XQA0
  0xB0F733C17FFDD6, 0xBD037DA0A050AD, 0x3DB144E02F6AFF, 0xF524E374680EC4,
  0x0E29951E2E5D5F, 0xE508E2DDA11526, 0x3EA6E4B552E2ED, 0x00018ECCDDF4B5, // XQA1
  0xBA4DB518CD6C7D, 0x251FE3CC061101, 0x6949A9121B2CB0, 0x6D2F82AD259B0C,
  0x75D92D60E17AC1, 0xC4F33AA41F1CE1, 0x43413FBE6A9B9B, 0x00022A81D8D556, // XRA0
  0xADBC70FC82E54A, 0xDDB0D5FADDEDB8, 0x34C80096A0EF9C, 0xAA96E0E45820C7,
  0x379AF87799994B, 0x27E2044961599E, 0xC6DB2B94FBF09F, 0x0000B87FC716C0, // XRA1
};

static const uint64_t B_gen[6*NLMB56] = {
  0x5497556EDD48A3, 0xB501546F1C056E, 0x46D049887D2A61, 0x9D450C4FEB9194,
  0x490D2B5864A4A6, 0xF5B9B883F276A6, 0x1F22CC287022D5, 0x0001BED4772E55, // XPB0
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000, // XPB1
  0xE2A3F93D8B6B8E, 0x71F51700FE1CFA, 0x228413C27C4948, 0xAF60BD62EF1A94,
  0x267E8A498FF4A4, 0x837FB00AD2A708, 0xAEF4328294E017, 0x000034080181D8, // XQB0
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000, // XQB1
  0x3B34FAFEFDC8E4, 0xF44977C3E64728, 0x62816F4E9A9208, 0xA262EC9D7DEAE9,
  0x43F45B68A2BA8A, 0xF5048176F112EA, 0x3702106D022634, 0x00007E8A50F02E, // XRB0
  0x78B7C1DA22CCB1, 0x9C99AD1D9230B3, 0x11813E23696D08, 0x39D48A53EBE157,
  0x407C932B35A682, 0xB54B445F6FD138, 0xD3BEF93B29A3F6, 0x000173FA910377, // XRB1   
};

static const unsigned int strat_Alice[MAX_Alice-1] = { 
  48, 28, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 
  2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 
  1, 1, 13, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 
  1, 1, 5, 4, 2, 1, 1, 2, 1, 1, 2, 1, 1, 1, 21, 
  12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 
  5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 9, 5, 3, 2, 1, 
  1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1 };

static const unsigned int strat_Bob[MAX_Bob-1] = { 
  66, 33, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 
  2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 
  2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 1, 2, 1, 1, 
  4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 
  1, 1, 2, 1, 1, 32, 16, 8, 4, 3, 1, 1, 1, 1, 2, 1, 
  1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 
  2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 
  2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 
  1, 2, 1, 1 };

void random_mod_order_B(unsigned char* random_digits);

void EphemeralKeyGeneration_A(const unsigned char* PrivateKeyA, unsigned char* PublicKeyA);
void EphemeralKeyGeneration_B(const unsigned char* PrivateKeyB, unsigned char* PublicKeyB);
void EphemeralSecretAgreement_A(const unsigned char* PrivateKeyA, const unsigned char* PublicKeyB, unsigned char* SharedSecretA);
void EphemeralSecretAgreement_B(const unsigned char* PrivateKeyB, const unsigned char* PublicKeyA, unsigned char* SharedSecretB);

#endif

// p := 0x002341F271773446CFC5FD681C520567BC65C783158AEA3FDC1767AE2FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

// XPA0 := 0x0003CCFC5E1F050030363E6920A0F7A4C6C71E63DE63A0E6475AF621995705F7C84500CB2BB61E950E19EAB8661D25C4A50ED279646CB48;
// XPA1 := 0x001AD1C1CAE7840EDDA6D8A924520F60E573D3B9DFAC6D189941CB22326D284A8816CC4249410FE80D68047D823C97D705246F869E3EA50;
// XQA0 := 0x000C7461738340EFCF09CE388F666EB38F7F3AFD42DC0B664D9F461F31AA2EDC6B4AB71BD42F4D7C058E13F64B237EF7DDD2ABC0DEB0C6C;
// XQA1 := 0x00025DE37157F50D75D320DD0682AB4A67E471586FBC2D31AA32E6957FA2B2614C4CD40A1E27283EAAF4272AE517847197432E2D61C85F5;
// XRA0 := 0x000F37AB34BA0CEAD94F43CDC50DE06AD19C67CE4928346E829CB92580DA84D7C36506A2516696BBE3AEB523AD7172A6D239513C5FD2516;
// XRA1 := 0x00196CA2ED06A657E90A73543F3902C208F410895B49CF84CD89BE9ED6E4EE7E8DF90B05F3FDB8BDFE489D1B3558E987013F9806036C5AC;

// XPB0 := 0x0008664865EA7D816F03B31E223C26D406A2C6CD0C3D667466056AAE85895EC37368BFC009DFAFCB3D97E639F65E9E45F46573B0637B7A9;
// XQB0 := 0x0012E84D7652558E694BF84C1FBDAAF99B83B4266C32EC65B10457BCAF94C63EB063681E8B1E7398C0B241C19B9665FDB9E1406DA3D3846;
// XRB0 := 0x001CD28597256D4FFE7E002E87870752A8F8A64A1CC78B5A2122074783F51B4FDE90E89C48ED91A8F4A0CCBACBFA7F51A89CE518A52B76C;
// XRB1 := 0x00147073290D78DD0CC8420B1188187D1A49DBFA24F26AAD46B2D9BB547DBB6F63A760ECB0C2B20BE52FB77BD2776C3D14BCBC404736AE4;

