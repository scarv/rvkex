#ifndef _SIDH_H
#define _SIDH_H

#include "curve.h"
#include "share.h"
#include "random.h"

static const uint64_t A_gen[6*NLMB56] = {
  0x93E6ED6C409592, 0x5D083011589AD8, 0xFD8D2CB67D0637, 0x9AC34FFB6361AD, 
  0xC80529EDA2330C, 0x7975630CBC1FAD, 0xAF6CE5D6D80238, 0xC454E62F803AA9, 
  0x0D10B2BA1F26CD, // XPA0
  0x196B802D2E30BF, 0x7E3541B8C96D15, 0xADAEEC0D61A26C, 0x219CE7703DD9D3, 
  0x80B6AD6852C0A2, 0x50BC749753F2A2, 0xE06233ADA7549A, 0xB5ED8CFFE3D7D7, 
  0x2DE66F26244538, // XPA1
  0xAD40E0F2091697, 0x4D83695107D03B, 0x1F3299005E2FCF, 0xAE22F30DECF222, 
  0xFF9684DFE478E6, 0x03DC7C6289D303, 0xDB200CDD3A20D3, 0x207D600DF35991, 
  0x10AE8417A4EC9B, // XQA0
  0x47183CFBA33F99, 0x0D74FE3402BCAE, 0x5B8CDA832D8AED, 0xCF06E4BD837EDF, 
  0x8E239F5363B86B, 0x38C840935C2010, 0xD8D8AD45BD202C, 0x54BD75CB1095C4, 
  0x34D132E098F437, // XQA1 
  0x17AA5427C27EE6, 0x1D9D32D2DC877C, 0x17CD8F71D5B02B, 0xFB8F6B60C11755, 
  0xBAD88E10C8395A, 0xD114E96119583C, 0x1FB71E9F5555F0, 0x2486E947A4479F, 
  0x384446F51BFA48, // XRA0
  0x5B19D76F666895, 0xC466CAB0F73C2E, 0x1817148FB2CF9C, 0x87C099E470A07B, 
  0x4F79439EC1873E, 0x21DE26D317FD29, 0xBFA10AD8A1F01F, 0x0B0B11D6FD58DF, 
  0x294F99E1B7D809, // XRA1
};

static const uint64_t B_gen[6*NLMB56] = {
  0xDB7287FF317A41, 0xDF630FC5FB2468, 0x0C5541C102040E, 0x9987B76511FCC3, 
  0x05E77960DD3CDC, 0x23322603A13316, 0x79DC8C26E5D115, 0x69F8FDE6A1CA29, 
  0x38CDBB00530EE9, // XPB0
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000, 
  0x00000000000000, // XPB1
  0x61D598AB5CB8DC, 0x2E3457A12B4292, 0x1F94E89627DCF8, 0xC98FD1DB73F631, 
  0xFD760E45415B71, 0x53859A9B13D604, 0xD76E965F91DF3E, 0xB6BC68FFED9570, 
  0x1541788D61C8F8, // XQB0
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000, 
  0x00000000000000, // XQB1
  0x5236A56A761ED7, 0x2E08BB99413D29, 0x021467CD088D72, 0x7AF859752245D3, 
  0x635BC16A5C2101, 0xAF5D0AB0250071, 0x8488164DE83E25, 0x2ECC493CA455D4, 
  0x2143A1499921A6, // XRB0
  0x04E444082D6607, 0x03E03FF342F5F3, 0x3D604D7B4B6E56, 0x2F4D9280E71F99,
  0x8A031E85828041, 0xD86179E877334C, 0xA1BB9D4C370F5D, 0x3682BB2B989086,
  0x3BE49489CCF6F9, // XRB1  
};

// Fixed parameters for isogeny tree computation
static const unsigned int strat_Alice[MAX_Alice-1] = { 
  61, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 
  4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 
  1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 29, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 
  1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 13, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 
  1, 1, 2, 1, 1, 5, 4, 2, 1, 1, 2, 1, 1, 2, 1, 1, 1 };

static const unsigned int strat_Bob[MAX_Bob-1] = { 
  71, 38, 21, 13, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 5, 4, 2, 1, 1, 2, 1, 
  1, 2, 1, 1, 1, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 17, 9, 
  5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 
  1, 4, 2, 1, 1, 2, 1, 1, 33, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 
  2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 1, 2, 
  1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1 };
  
void random_mod_order_B(unsigned char* random_digits);

void EphemeralKeyGeneration_A(const unsigned char* PrivateKeyA, unsigned char* PublicKeyA);
void EphemeralKeyGeneration_B(const unsigned char* PrivateKeyB, unsigned char* PublicKeyB);
void EphemeralSecretAgreement_A(const unsigned char* PrivateKeyA, const unsigned char* PublicKeyB, unsigned char* SharedSecretA);
void EphemeralSecretAgreement_B(const unsigned char* PrivateKeyB, const unsigned char* PublicKeyA, unsigned char* SharedSecretB);

#endif

// p := 0x04066F541811E1E6045C6BDDA77A4D01B9BF6C87B7E7DAF13085BDA2211E7A0ABFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

// XPA0 := 0x002ED31A03825FA14BC1D92C503C061D843223E611A92D7C5FBEC0F2C915EE7EEE73374DF6A1161EA00CDCB786155E21FD38220C3772CE670BC68274B851678;
// XPA1 := 0x01EE4E4E9448FBBAB4B5BAEF280A99B7BF86A1CE05D55BD603C3BA9D7C08FD8DE7968B49A78851FFBC6D0A17CB2FA1B57F3BABEF87720DD9A489B5581F915D2;
// XQA0 := 0x0325CF6A8E2C6183A8B9932198039A7F965BA8587B67925D08D809DBF9A69DE1B621F7F134FA2DAB82FF5A2615F92CC71419FFFAAF86A290D604AB167616461;
// XQA1 := 0x03E7B0494C8E60A8B72308AE09ED34845B34EA0911E356B77A11872CF7FEEFF745D98D0624097BC1AD7CD2ADF7FFC2C1AA5BA3C6684B964FA555A0715E57DB1;
// XRA0 := 0x03D24CF1F347F1DA54C1696442E6AFC192CEE5E320905E0EAB3C9D3FB595CA26C154F39427A0416A9F36337354CF1E6E5AEDD73DF80C710026D49550AC8CE9F;
// XRA1 := 0x006869EA28E4CEE05DCEE8B08ACD59775D03DAA0DC8B094C85156C212C23C72CB2AB2D2D90D46375AA6D66E58E44F8F219431D3006FDED7993F51649C029498;

// XPB0 := 0x032D03FD1E99ED0CB05C0707AF74617CBEA5AC6B75905B4B54B1B0C2D73697840155E7B1005EFB02B5D02797A8B66A5D258C76A3C9EF745CECE11E9A178BADF;
// XQB0 := 0x039014A74763076675D24CF3FA28318DAC75BCB04E54ADDC6494693F72EBB7DA7DC6A3BBCD188DAD5BECE9D6BB4ABDD05DB38C5FBE52D985DCAF74422C24D53;
// XRB0 := 0x000C1465FD048FFB8BF2158ED57F0CFFF0C4D5A4397C7542D722567700FDBB8B2825CAB4B725764F5F528294B7F95C17D560E25660AD3D07AB011D95B2CB522;
// XRB1 := 0x0288165466888BE1E78DB339034E2B8C7BDF0483BFA7AB943DFA05B2D1712317916690F5E713740E7C7D4838296E67357DC34E3460A95C330D5169721981758;

