#ifndef _SIDH_H
#define _SIDH_H

#include "curve.h"
#include "share.h"
#include "random.h"

static const uint64_t A_gen[6*NLMB56] = {
  0xC6F15019EC96A7, 0x5E8AEA0E717712, 0x03C067C819D29E, 0xF454425FE307D9, 
  0x215D9AD5E6D459, 0x57C5BC30C6641D, 0x98CEB56363DAB2, 0x8ED60AFE12A079, 
  0x7EE95E2136CF09, 0xB9C7F5AAAB8385, 0x00E17F4B2436F5, // XPA0
  0x32D3E4BA9CC3EE, 0x0CBD34E4FEDB01, 0x1B7125C87BEE96, 0xD615BF3CFAA355, 
  0xC20DC367D66A25, 0x69FCCF8C607C76, 0xC7371D29AEB8FC, 0x7E19C1F3D1D80E, 
  0x6216FA14E5F0C1, 0xD061A4B1A47D79, 0x024B17F2A3D6AE, // XPA1
  0xA5B91D7C945D3D, 0xE39A5F7C12CA8B, 0x1E8F87985B01CB, 0xCABF82F5BC5235, 
  0x474ECCA9FAA2D2, 0x0F7F84314FEAF6, 0x3DC71DFDA18CC9, 0xABF454F86BCA58, 
  0xE09B0905341744, 0xFAC1A654CE0DD3, 0x01D4EEED747A74, // XQA0
  0x3C001E8B3AA238, 0xE128CB31E08A94, 0xE04D02266E8A63, 0xA2D260214EF65F, 
  0x3DA25018E22684, 0x9A627E97D4F485, 0x8CAF6F51AE38EA, 0xD030FC04E6D3BA, 
  0x31B946CD85D21A, 0x4D80BA4039DC78, 0x006EB54E32C40D, // XQA1 
  0x0311261DD0782C, 0xFEC25B3AE64BBC, 0x9F21B8A8981B15, 0xC0B52CD5FFC45B, 
  0x65A016702C6AA3, 0xB19FBDA8501E48, 0xF45057DE236DE6, 0xE82BF3E8E0C3FB, 
  0x432B134B7751DA, 0x4546288F24DF8C, 0x024BBAE7F9FC63, // XRA0
  0xC873B980435A77, 0x3C2B4A97F70E0F, 0x415C7FA4DE96F4, 0xEED95643E443FD, 
  0x8DB57C51B354E5, 0x4370B213477161, 0x92F3F9062EA152, 0x8469F70E36FD9C, 
  0x14816364251586, 0xB48F4965D0F4BB, 0x01CBC3D5A62029, // XRA1
};

static const uint64_t B_gen[6*NLMB56] = {
  0x2B95C6C8E180E4, 0x922161D2F4FBC3, 0xCBF83091BDB340, 0x42CC0AD4CC7E38,
  0xFA7E1B14FBD7D7, 0xD3208BDA695715, 0x7B529CA8384A87, 0xDE235018858B24,
  0xF444508CD15A8D, 0x13E14E6CE00A61, 0x003CE8DA31F293, // XPB0
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, // XPB1
  0x65A9F586DB4A16, 0x87712F10D95E6C, 0x9D5AAC3B83584B, 0xCDAA98182C8261, 
  0x4C15588FD2304E, 0xEB0709F029DE7D, 0xFD982EB317BAF8, 0xD8639B101D38DE, 
  0x72254762FB1930, 0xAEAD3E88DB25FD, 0x01D83DEF777C04, // XQB0
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, // XQB1
  0x3D767A87897A0C, 0xA03C1879ECD4D3, 0x595C28A36FFBA1, 0x3FF66A2A7FD0FB, 
  0x5A91230E56FAF5, 0x508B8CB55E954D, 0x89972A264A3A59, 0xFB2FC4D4E4B37A, 
  0xE79B85A2E69A97, 0x191F644D6ABE0E, 0x00BD6BD39BE12E, // XRB0
  0x79235E3CC79B37, 0x51E0358A9AB2EA, 0x3B725CB5951809, 0x24637F1DD0C191, 
  0x31B67DAB9D1907, 0x9DF56DEC45E284, 0x1CE5F5B208C90B, 0xA11C5DBEC38D85, 
  0x98E6DE4F702C00, 0x3D096D3C0A4F88, 0x00010FD0A206B2, // XRB1  
};

static const unsigned int strat_Alice[MAX_Alice-1] = { 
  67, 37, 21, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 
  2, 1, 1, 1, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 16, 9, 
  5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 
  1, 4, 2, 1, 1, 2, 1, 1, 33, 16, 8, 5, 2, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 2, 1, 
  1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 1, 2, 1, 1, 
  4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1  };

static const unsigned int strat_Bob[MAX_Bob-1] = { 
  86, 48, 27, 15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 
  1, 3, 2, 1, 1, 1, 1, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 
  1, 1, 2, 1, 1, 1, 21, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 
  1, 1, 2, 1, 1, 1, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 38, 
  21, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 
  9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 17, 9, 5, 3, 2, 1, 1, 
  1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 
  1, 1 };
  
void random_mod_order_B(unsigned char* random_digits);

void EphemeralKeyGeneration_A(const unsigned char* PrivateKeyA, unsigned char* PublicKeyA);
void EphemeralKeyGeneration_B(const unsigned char* PrivateKeyB, unsigned char* PublicKeyB);
void EphemeralSecretAgreement_A(const unsigned char* PrivateKeyA, const unsigned char* PublicKeyB, unsigned char* SharedSecretA);
void EphemeralSecretAgreement_B(const unsigned char* PrivateKeyB, const unsigned char* PublicKeyA, unsigned char* SharedSecretB);

#endif

// p := 0x27BF6A768819010C251E7D88CB255B2FA10C4252A9AE7BF45048FF9ABB1784DE8AA5AB02E6E01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

// XPA0 := 0x1B368BC6019B46CD802129209B3E65B98BC64A92BC4DB2F9F3AC96B97A1B9C124DF549B528F18BEECB1666D27D47530435E84221272F3A97FB80527D8F8A359F8F1598D365744CA3070A5F26C;
// XPA1 := 0x1459685DCA7112D1F6030DBC98F2C9CBB41617B6AD913E6523416CCBD8ED9C7841D97DF83092B9B3F2AF00D62E08DAD8FA743CBCCCC1782BE0186A3432D3C97C37CA16873BEDE01F0637C1AA2;
// XQA0 := 0x025DA39EC90CDFB9BC0F772CDA52CB8B5A9F478D7AF8DBBA0AEB3E52432822DD88C38F4E3AEC0746E56149F1FE89707C77F8BA4134568629724F4A8E34B06BFE5C5E66E0867EC38B283798B8A;
// XQA1 := 0x2250E1959256AE502428338CB4715399551AEC78D8935B2DC73FCDCFBDB1A0118A2D3EF03489BA6F637B1C7FEE7E5F31340A1A537B76B5B736B4CDD284918918E8C986FC02741FB8C98F0A0ED;
// XRA0 := 0x1B36A006D05F9E370D5078CCA54A16845B2BFF737C865368707C0DBBE9F5A62A9B9C79ADF11932A9FA4806210E25C92DB019CC146706DFBC7FA2638ECC4343C1E390426FAA7F2F07FDA163FB5;
// XRA1 := 0x183C9ABF2297CA69699357F58FED92553436BBEBA2C3600D89522E7009D19EA5D6C18CFF993AA3AA33923ED93592B0637ED0B33ADF12388AE912BC4AE4749E2DF3C3292994DCF37747518A992;

// XPB0 := 0x1587822E647707ED4313D3BE6A811A694FB201561111838A0816BFB5DEC625D23772DE48A26D78C04EEB26CA4A571C67CE4DC4C620282876B2F2FC2633CA548C3AB0C45CC991417A56F7FEFEB;
// XQB0 := 0x14E647CB19B7EAAAC640A9C26B9C26DB7DEDA8FC9399F4F8CE620D2B2200480F4338755AE16D0E090F15EA1882166836A478C6E161C938E4EB8C2DD779B45FFDD17DCDF158AF48DE126B3A047;
// XRB0 := 0x1DB73BC2DE666D24E59AF5E23B79251BA0D189629EF87E56C38778A448FACE312D08EDFB876C3FD45ECF3746D96E2CADBBA08B1A206C47DDD93137059E34C90E2E42E10F30F6E5F52DED74222;
// XRB1 := 0x1B2C30180DAF5D91871555CE8EFEC76A4D521F877B754311228C7180A3E2318B4E7A00341FF99F34E35BF7A1053CA76FD77C0AFAE38E2091862AB4F1DD4C8D9C83DE37ACBA6646EDB4C238B48;

