#ifndef _SIDH_H
#define _SIDH_H

#include "curve.h"
#include "share.h"
#include "random.h"

static const uint64_t A_gen[6*NLMB56] = {
  0xB74000BAA8223F, 0x939DEC20884F46, 0x14A04DBA52630F, 0xB3DBC16FB97BA7, 
  0x82082536745B1A, 0x1117157F446F9E, 0xAC60121A018490, 0x281B7EB417A1B1, 
  0x3F8C9689714F9D, 0x490FB92194C02D, 0x90A5E1D5CC1ADD, 0xD063AE7257A348, 
  0xFC9A3BEBCFE852, 0x0000000068881D, // XPA0
  0x3B96F593944C35, 0x29C90B74AEB78B, 0xC4ACF1AB26681E, 0x111BE520AC30FD, 
  0xFF870AAAE3A4B8, 0xF875BDB738D64E, 0x3AF00ECD7ED6BC, 0xDB9E437E42B82E, 
  0x67773D4FC8AC7E, 0xF7D45E2F7C9820, 0xEE4E712813A5FE, 0xAE0BB84AEFB7DD, 
  0xAF02CBBD4E0A05, 0x0000000040D4C4, // XPA1
  0x38680A8CA94C47, 0x22E7FED70F93CC, 0x0ADB67762E7338, 0xA4EDE549F005AC, 
  0xC594A71FDD2C43, 0xD48645C2B04721, 0x772F2E4D4CA4DC, 0xF212598D392CA5, 
  0x78FAD42DB6BBF5, 0x8A51E76AF0EBCB, 0xFC2A0D57215101, 0xE7F1EAFEF5156F, 
  0xC4564B4A5A263B, 0x000000000557C4, // XQA0
  0x5BF3079F4CDF75, 0x43E80EF3ECFF37, 0x5C7AD1FBFE74B0, 0xDBF217376CBE3C, 
  0xD4C06327A7E29C, 0x2111649C438BF3, 0xD8C31261BA2E97, 0xAAA98375921874, 
  0xD42EE472061CBE, 0xCC7D834E3AE962, 0x277C6471548F25, 0x3929D578F806C2, 
  0xB5BC340B36DD60, 0x0000000047E940, // XQA1 
  0x25D41059F179A1, 0x0A1D83F71600C5, 0xB23F35A596899A, 0x39106BFDEED6D2, 
  0x115C7E707270C2, 0x276CA1A4E83694, 0x84186A602925A0, 0xF8AF72D7F9FEF6, 
  0x7466A1B2315BBC, 0x373472ABF42D98, 0xF21C2BDD6B317C, 0x20CAC225F02CF2, 
  0x2EC14BA67D1DE8, 0x000000003D0500, // XRA0
  0x9FD1CC3EE8412F, 0x9B2FD23E9B794F, 0xE42B67DB32E40A, 0xBCE726192A2542, 
  0x2DA18E94FCA045, 0x96DC1BC38E7CDA, 0x7F0F6752487DE2, 0x8B920D02C2628E, 
  0xA193F0BFB512B0, 0x0A88A31C37C453, 0x770A29746DED84, 0x6F55CCBE1B4745, 
  0xE4FC597EB46FF4, 0x000000003DA962, // XRA1
};

static const uint64_t B_gen[6*NLMB56] = {
  0xAF4015F88C7559, 0xC36E963185691A, 0x4DD6E27478C5B8, 0x9DC77EF2A185DE, 
  0x22943BBEE46BEB, 0x1A3EC62798792D, 0x4A598084B31D69, 0x8846EDC4D13D51, 
  0xC086352BEA985B, 0xEDA0C7B0E13C3C, 0x54D898F97BE6C9, 0xB77590A79D78A1, 
  0xB4E9A00FE30E97, 0x000000002E4887, // XPB0
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000, 
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000, 
  0x00000000000000, 0x00000000000000, // XPB1
  0xFA532113405B92, 0x7A05EEE08E7CB3, 0x46FC38D67CE54F, 0xDF1EFDDC2C8BCE, 
  0x8B08587FAE3110, 0xD6B8246FA22B05, 0x7B8A6C905A5DBD, 0xA8C0747F514F70, 
  0xF93C4FCB2472FD, 0xB058038C122668, 0x7CC2602E766A75, 0x536923567A5C03, 
  0xC743FFC7B4E18A, 0x0000000028B27A, // XQB0
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000,
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000, 
  0x00000000000000, 0x00000000000000, 0x00000000000000, 0x00000000000000, 
  0x00000000000000, 0x00000000000000, // XQB1
  0x016D1D6D1C7BD1, 0x8F39C491B56457, 0x55945203DECCB3, 0x4883DFB910AC8A, 
  0x8CA9D0F17D1FF2, 0x8562BBAF515C24, 0x01BCBDDB1CB67D, 0xEF1E0DEABD8878, 
  0x905C9E6756249E, 0x21CB2B67FCF402, 0x9554570CE95754, 0xD583855510F87E, 
  0x7DBF8DE4AA5343, 0x000000000196CC, // XRB0
  0x899ED16EF4F0A0, 0xDC622A4B58C967, 0xB1268181998376, 0x17303D1C1DCFE0, 
  0xD79347DEBB953E, 0x9ABB344D3A82C2, 0x2DEDD2820552B2, 0xE37E1B31D5FD1B, 
  0x044E531B15C03A, 0xB604A69676FC78, 0xDDFBB2E39B66A6, 0xF311B2C56AD541, 
  0xD93B82CC738174, 0x0000000066F2DE, // XRB1  
};

// Fixed parameters for isogeny tree computation
static const unsigned int strat_Alice[MAX_Alice-1] = { 
  80, 48, 27, 15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 
  1, 3, 2, 1, 1, 1, 1, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 
  1, 1, 2, 1, 1, 1, 21, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 
  1, 1, 1, 2, 1, 1, 1, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 
  33, 20, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 
  1, 1, 8, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 
  1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1 };

static const unsigned int strat_Bob[MAX_Bob-1] = { 
  112, 63, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 
  1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 
  1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 31, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 
  1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 
  2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 49, 31, 16, 8, 4, 2, 
  1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 
  15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 
  1, 1, 1, 21, 12, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 5, 3, 2, 1, 1, 1, 1, 
  2, 1, 1, 1, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1 };

  
void random_mod_order_B(unsigned char* random_digits);

void EphemeralKeyGeneration_A(const unsigned char* PrivateKeyA, unsigned char* PublicKeyA);
void EphemeralKeyGeneration_B(const unsigned char* PrivateKeyB, unsigned char* PublicKeyB);
void EphemeralSecretAgreement_A(const unsigned char* PrivateKeyA, const unsigned char* PublicKeyB, unsigned char* SharedSecretA);
void EphemeralSecretAgreement_B(const unsigned char* PrivateKeyB, const unsigned char* PublicKeyA, unsigned char* SharedSecretB);

#endif

// p := 0x6FE5D541F71C0E12909F97BADC668562B5045CB25748084E9867D6EBE876DA959B1A13F7CC76E3EC968549F878A8EEAFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

// XPA0 := 0x4514F8CC94B140F24874F8B87281FA6004CA5B3637C68AC0C0BDB29838051F385FBBCC300BBB24BFBBF6710D7DC8B29ACB81E429BD1BD5629AD0ECAD7C90622F6BB801D0337EE6BC78A7F12FDCB09DECFAE8BFD643C89C3BAC1D87F8B6FA;
// XPA1 := 0x158ABF500B5914B3A96CED5FDB37D6DD925F2D6E4F7FEA3CC16E1085754077737EA6F8CC74938D971DA289DCF2435BCAC1897D2627693F9BB167DC01BE34AC494C60B8A0F65A28D7A31EA0D54640653A8099CE5A84E4F0168D818AF02041;
// XQA0 := 0x1723D2BFA01A78BF4E39E3A333F8A7E0B415A17F208D3419E7591D59D8ABDB7EE6D2B2DFCB21AC29A40F837983C0F057FD041AD93237704F1597D87F074F682961A38B5489D1019924F8A0EF5E4F1B2E64A7BA536E219F5090F76276290E;
// XQA1 := 0x2569D7EAFB6C60B244EF49E05B5E23F73C4F44169A7E02405E90CEB680CB0756054AC0E3DCE95E2950334262CC973235C2F87D89500BCD465B078BD0DEBDF322A2F86AEDFDCFEE65C09377EFBA0C5384DD837BEDB710209FBC8DDB8C35C7;
// XRA0 := 0x6066E07F3C0D964E8BC963519FAC8397DF477AEA9A067F3BE343BC53C883AF29CCF008E5A30719A29357A8C33EB3600CD078AF1C40ED5792763A4D213EBDE44CC623195C387E0201E7231C529A15AF5AB743EE9E7C9C37AF3051167525BB;
// XRA1 := 0x50E30C2C06494249BC4A144EB5F31212BD05A2AF0CB3064C322FC3604FC5F5FE3A08FB3A02B05A48557E15C992254FFC8910B72B8E1328B4893CDCFBFC003878881CE390D909E39F83C5006E0AE979587775443483D13C65B107FADA5165;

// XPB0 := 0x605D4697A245C394B98024A5554746DC12FF56D0C6F15D2F48123B6D9C498EEE98E8F7CD6E216E2F1FF7CE0C969CCA29CAA2FAA57174EF985AC0A504260018760E9FDF67467E20C13982FF5B49B8BEAB05F6023AF873F827400E453432FE;
// XQB0 := 0x5BF9544781803CBD7E0EA8B96D934C5CBCA970F9CC327A0A7E4DAD931EC29BAA8A854B8A9FDE5409AF96C5426FA375D99C68E9AE714172D7F04502D45307FA4839F39A28338BBAFD54A461A535408367D5132E6AA0D3DA6973360F8CD0F1;
// XRB0 := 0x55E5124A05D4809585F67FE9EA1F02A06CD411F38588BB631BF789C3F98D1C3325843BB53D9B011D8BD1F682C0E4D8A5E723364364E40DAD1B7A476716AC7D1BA705CCDD680BFD4FE4739CC21A9A59ED544B82566BF633E8950186A79FE3;
// XRB1 := 0x5AC57EAFD6CC7569E8B53A148721953262C5B404C143380ADCC184B6C21F0CAFE095B7E9C79CA88791F9A72F1B2F3121829B2622515B694A16875ED637F421B539E66F2FEF1CE8DCEFC8AEA608055E9C44077266AB64611BF851BA06C821;

